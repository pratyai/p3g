sym M, N, S
var i, j
decl alpha, A, B
out B

; Nested loops for TRMM computation
; MAIN OUTER LOOP
(A[0,0], B[0,0] => B[0,0]) L_i | for i = 0 to M-1:
    (A[0,0], B[0,0] => B[0,0]) L_j | for j = 0 to N-1:
        ; B[i, j] += np.dot(A[i + 1:, i], B[i + 1:, j])
        (B[i,j], A[i+1:M-1, i], B[i+1:M-1, j] => B[i,j]) S_dot_add | op(B_update_dot_add)

; Final scalar multiplication
(B[0:M-1, 0:N-1], alpha[0] => B[0:M-1, 0:N-1]) S_scale_B | op(B_scale_by_alpha)
