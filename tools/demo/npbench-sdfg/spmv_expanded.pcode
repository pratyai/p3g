decl A, A_col, A_row, accum, x, y
sym M, N, nnz, start, stop
var i, k
out A, A_col, A_row, x, y

(A[0], A_col[0], accum[0], x[0] => accum[0], y[0]) ().L1| for i = 0 to (-1 + M):
    ( => ) noop | op(NOOP_state_block)
    (accum[i] => accum[i]) ().T2| op(setup_accum)
    (A[0], A_col[0], accum[0], x[0] => accum[0]) (T2).L3| for k = start to (-1 + stop):
        (accum[i], A_col[k], A[k], x[0:(-1 + N)] => accum[i]) (T2).T4| op(mac)
    (accum[i], y[i] => y[i]) (L3).T5| op(copy_accum_to_y)